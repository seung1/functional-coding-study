# 액션과 계산, 데이터의 차이를 알기

액션과 계산, 데이터가 어떻게 다른지 알아보고 이미 있는 코드에서 어떤 부분이 액션인지 찾아봤습니다.

## 데이터

- 이벤트에 대한 사실
- 개발자가 처리과정에서 필요한 데이터를 만들기도 한다.

### 불변성

- **copy on write** : 변경할때 복사본을 만든다.
  - 복사를 최대한 늦춰서 불필요한 메모리 사용을 줄인다.
  - 읽기만 하는 경우 복사가 일어나지 않으므로 메모리, 성능에서 이점이 있다.
- **방어적 복사** : 보관하려는 데이터의 복사본을 만든다.
  - 원본 데이터가 **외부 코드에서 의도치 않게 변경**되는 것을 막는다.
  - 외부에 데이터를 줄 때나 받을 때 **즉시 새로운 복사본**을 만들어 전달한다.

### 데이터의 장점

- 직렬화 : 직렬화된 데이터는 전송하거나 저장했다가 읽기 쉽다.
- 동일성 비교 : 액션이나 계산과 달리 서로 비교할 수 있다.
- 자유로운 해석 : 여러가지 방법으로 해석할 수 있다.

## 계산

- 입력값으로 출력값을 만드는 것
- 계산을 호출하는 코드를 계산 결과와 바꿀 수 있기 때문에 참조투명하다.

### 액션보다 계산이 좋은 이유

- 테스트하기 쉽다.
- 기계적인 분석이 쉽다.
- 계산은 조합하기에 좋다.

### 걱정하지 않아도 되는것 (액션에서 걱정해야 하는 것)

- 동시에 실행되는것
- 과거에 실행되었던 것이나 미래에 실행할 것
- 실행 횟수

## 액션

- 외부 세계에 영향을 주거나 받는 것
- 코드 안쪽에 액션을 실행하는 코드는 프로그램 전체를 액션으로 만든다.

### 액션의 유형

- 함수 호출
- 메서드 호출
- 생성자
- 표현식 - 변수 참조, 속성 참조, 배열 참조
- 상태 - 값 할당, 속성 삭제

### 액션을 잘 사용하기 위한 방법

- 가능한 액션을 적게 사용한다.
- 액션은 가능한 작게 만든다.
- 내부에 계산과 데이터만 있고 가장 바깥쪽에 액션이 있는 구조가 이상적이다.
- 액션이 호출시점과 횟수에 덜 의존하도록 만든다.

## 액션을 계산과 데이터로 나누기

- 계속 나누다보면 복잡해진다고 생각이 들수 있지만, 숨어있는 다른 액션이나 계산 또는 데이터를 발견하기 위해 나누는것이 좋다.
- 언제 나누는 것을 멈춰야할지 아는 것이 중요하다.
- 계산도 더 작은 계산으로 나눌수 있는데, 이때 첫번째 계산의 결과가 두번째 계산의 입력이 된다.

## [실습] 10명을 추천한 사용자에게는 더 좋은 쿠폰 제공

### 나의 수도 코드

```
전체 사용자 이메일 리스트 가져오기
쿠폰에서 good 가져오기
모든 사용자에게 good 전송하기

10명이상 추천한 사용자 이메일 가져오기
쿠폰에서 best 가져오기
10명이상 추천한 사람에게 전송하기
```

- 위 코드를 기반으로, good과 best를 입력받는 함수를 선언하고 두번 실행한다.

### 나의 실습 코드

```ts
const 쿠폰_제공_함수 = (type: "good" | "best") => {
  const 이메일_리스트 = 이메일_리스트_가져오기(type); // 액션
  const 쿠폰 = 쿠폰_가져오기(type); // 액션
  이메일_전송하기(이메일_리스트, 쿠폰); // 액션
};

쿠폰_제공_함수("good"); // 액션
쿠폰_제공_함수("best"); // 액션
```

### 책의 코드

```ts
const 쿠폰 = 전체쿠폰_가져오기(); // 액션
const good_쿠폰 = 쿠폰_선별하기(쿠폰, "good"); // 계산
const best_쿠폰 = 쿠폰_선별하기(쿠폰, "best"); // 계산
const 사용자_리스트 = 사용자_가져오기(); // 액션
const 이메일_내용 = 이메일_구성하기(사용자_리스트, good_쿠폰, best_쿠폰); // 계산
이메일_전송하기(이메일_내용); // 액션
```

- 최대한 잘게 나눠서 액션과 계산을 구분했다.
- `이메일_구성하기` 을 구현하기 위해, 내가 만약 구현했다면 쿠폰을 계산해서 하나의 쿠폰만 넘겨줬을텐데, 두개다 넘기고 계산을 안에서 한것이 인상적이다.
- `이메일_전송하기` 이 부분이 액션인데, 책의 코드에서는 최대한 밖에서 실행한 반면, 나의 코드에서는 함수안에 들어가 있어서 모든 것이 액션이 되어버렸다.

::: tip
최대한 잘게 나눠서 액션과 계산을 구분하는 것이 중요하다.

내부에 계산과 데이터만 있고 가장 바깥쪽에 액션이 있는 구조가 이상적이다.
:::

> **스터디 회차:** 2회차 (2025년 8월 14일)
